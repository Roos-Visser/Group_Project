---
title: "Visualise billboard data"
output: html_notebook
---
 

```{r}
library(tidyverse)
library(ggthemes)
```

```{r}
billboard <- read_csv("billboard.csv")
```

```{r}
billboard_pop_column <- billboard %>%
  group_by(genre, year) %>%
  mutate(
    pos = 101 - pos,
    popularity = pos*count
  )

billboard_plot <-  billboard_pop_column%>%
  summarize(
    popularity = sum(popularity),
    total_count = sum(count)
  ) %>%
  mutate(
    popularity = popularity
  ) %>%
  filter(
    genre != "jazz",
    genre != "religious",
    genre != "disco",
    genre != "classical/soundtrack",
    genre != "swing",
    genre != "reggae",
    genre != "blues",
    genre != "country",
    genre != "folk",
    genre != "alternative/indie"
  )
```

```{r}
ggplot(billboard_plot) +
  geom_line(mapping = aes(x = year, y = popularity, color = genre)) +
  theme_hc() +
  xlab("Year") + ylab("Popularity") + 
  ggtitle("Popularity of genres") +
  ggsave("billboard_genres.pdf")
  
```

